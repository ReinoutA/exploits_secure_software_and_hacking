# <span style="color: yellow;">Scenario 5</span>

## Context
***
- server_data is <span style="color: green;">accessible</span>
- stack canaries are <span style="color: green;">enabled</span>
- DEP is <span style="color: red;">disabled</span>
- ASLR is <span style="color: red;">disabled</span>

## Exploit overview
***
This scenario is broken. The server always responds with error code 404, even with regular curls.
## Challenges & Decisions
***
There are at least two options.

1. Leaking the canaries with the POST. Since NX and PIE are disabled, we can utilize code injection (sc1) or initiate a reverse shell (sc3 Method 2).

2. Utilizing use-after-free vulnerabilities in ```parse_request```, along with a function pointer to direct to injected shell code. We can inject payload as long as it doesn't overwrite the canary (unless the canary is leaked with the POST).





## Preventive Measures
***
- Safer alternatives like ```snprintf``` should be used.
- Although stack canaries and secure library function make code injection harder, they do not always prevent it outright:
    + Code injection is possible without a buffer overflow. Attacker can overwrite function pointers.
    + Attacker can leak the canaries with the POST.
- Removing use-after-frees.